{
	"version": "2.0.0",
  "inputs": [
    {
      "description": ".helm-values/values.<Branch>.yaml",
      "type": "promptString",
      "default": "main",
      "id": "branch"
    },
    {
      "description": "CAREFUL - Branch name to override",
      "type": "promptString",
      "default": "",
      "id": "branch-to-override"
    },
    {
      "description": "CAREFUL - Branch name to copy from",
      "type": "promptString",
      "default": "",
      "id": "branch-to-copy"
    },
    {
      "id": "confirmation",
      "type": "promptString",
      "description": "CAREFUL !!!! You will override a branch on the remote, this is irreversible. Type 'agree' to continue",
      "default": ""
    }
  ],
	"tasks": [
    {
      "label": "üóëÔ∏è Docker Compose",
      "type": "shell",
      "command": "docker",
      "args": [
        "compose", 
        "down", 
        // "-v" // -v also removes volumes
      ],
      "problemMatcher": [],
      "options": {
        "cwd": "${workspaceFolder}/dev",
        "env": {
          "COMPOSE_PROFILES": "without_api, with_api"
        },
        "statusbar": {"hide": true}
      }
    },
    //
    //
    //
    {
      "label": "üß∂ Lint",
      "type": "shell",
      "command": "bun",
      "args": ["run", "lint"],
      "problemMatcher": ["$tsc", "$eslint-stylish"],
      "options": {
        "cwd": "${workspaceFolder}/api",
      }
    },
    {
      "label": "Build w/ bun (dev only)",
      "type": "shell",
      "command": "bun",
      "args": ["run", "build:dev"],
      "problemMatcher": "$tsc",
      "options": {
        "statusbar": {"hide": true},
        "cwd": "${workspaceFolder}/api",
        "env": {
          "NODE_ENV": "development"
        }
      },
    },
    //
    //
    //
    {
      "label": "ü™ñ Test helm chart",
      "command": "helm",
      "args": [
        "template",
        ".helm",
        "-f",
        ".helm-values/values.${input:branch}.yaml",
        "--debug"
      ],
      "problemMatcher": []
    },
    {
      "label": "ü™ñ Build helm dependencies",
      "command": "helm",
      "args": [
        "dependency",
        "build",
        ".helm"
      ],
      "problemMatcher": []
    },
    {
      "label": "‚ö†Ô∏è Override branch with another",
      "type": "shell",
      "command": "if [ \"${input:confirmation}\" = \"agree\" ]; then git checkout ${input:branch-to-override} -- && git reset --hard ${input:branch-to-copy} -- && git push --force; else echo 'Did not agree explicitely'; exit 0; fi",
      "problemMatcher": [],
      "options": {
        "statusbar": {"hide": true}
      }
    },
    // {
    //   "label": "Run ESLint on project open",
    //   "type": "shell",
    //   "command": "bunx",
    //   "args": ["eslint"],
    //   "problemMatcher": ["$eslint-stylish"],
    //   "presentation": {
    //     "echo": true,
    //     "revealProblems": "always",
    //     "focus": false,
    //     "panel": "shared",
    //     "showReuseMessage": true,
    //     "clear": false
    //   },
    //   "options": {
    //     "cwd": "${workspaceFolder}/api",
    //     "statusbar": { "hide": true }
    //   },
    //   "runOptions": {
    //     "runOn": "folderOpen"
    //   }
    // }
  ]
}